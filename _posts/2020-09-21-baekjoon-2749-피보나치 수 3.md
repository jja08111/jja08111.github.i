---
title: "[Baekjoon,2749] 피보나치 수 3"
date: 2020-09-21 23:20:00 -0400
categories: algorithm 
tags:
- baekjoon 
- divide_and_conquer
- matrix 
use_math: true
---
피보나치의 수는 다음과 같이 증가한다. 
- $ 0,1,1,2,3,5,8,13, \dots $

[점화식의 행렬로 표현](https://cloge.tistory.com/33)
```cpp
#include <iostream>
#include <vector>
using namespace std;

typedef vector<vector<long long> > Mat;

const int MOD=1000000;
const int N=2;

// 두 행렬의 곱셈 결과를 반환한다. 
Mat operator*(const Mat& a, const Mat& b)
{
    Mat ret(N,vector<long long>(N,0));
    for(int i=0;i<N;++i)
        for(int j=0;j<N;++j)
        {
            for(int k=0;k<N;++k)
                ret[i][j]+=a[i][k]*b[k][j];
            ret[i][j]%=MOD;
        }
    return ret;
}

// 행렬의 거듭 제곱
Mat pow(const Mat& mat, long long p)
{
    // 기저 사례: 항등 행렬 반환
    if(p==0)
    {
        Mat temp(N,vector<long long>(N));
        for(int i=0;i<N;++i)
            temp[i][i]=1;
        return temp;
    }
    if(p&1)
        return mat*pow(mat,p-1);
    Mat half=pow(mat,p/2);
    return half*half;
}

int main()
{
    long long p;
    cin>>p;
    
    if(p<2)
    {
        cout<<1<<endl;
        return 0;
    }
    
    // 피보나치 점화식을 행렬로 변환하여 해결한다. 
    Mat mat(N,vector<long long>(N,0));
    mat[0][0]=mat[0][1]=mat[1][0]=1;
    
    Mat ret=pow(mat,p);
    cout<<ret[0][1]<<endl;

    return 0;
}

```
